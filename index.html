<!DOCTYPE html>



<html lang="en-us">



<head>



    <meta charset="UTF-8">

    <title>Train Scheduler</title>



    <!-- Bootstrap -->

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>



    <!-- Firebase Reference -->

    <script src="https://www.gstatic.com/firebasejs/5.5.3/firebase.js"></script>



    <!-- Moment.js Reference -->

    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.2/moment.min.js"></script>

<style>
    #train-table th,

td {

  display: inline-block;

  width: 16.575%;

}
</style>
    
</head>



<body>



    <!-- train Tracker -->

    <div class="container">



        <!-- Jumbotron -->

        <div class="jumbotron" style="background-color: black; color: white">

            <h1 class="text-center">Express Train Scheduler</h1>

            <h3 class="text-center">Up to the minute info at your fingertips</h3>

        </div>



        <div class="row">



            <div class="col-md-12">



                <!-- Current trains-->

                <div class="card mb-4">

                    <div class="card-header">Current Train Schedule</div>

                    <div class="card-body">

                        <table class="table table-sm table-hover" id='train-table'>

                            <thead>

                                <tr>

                                    <th scope="col">Train Name</th>

                                    <th scope="col">Destination</th>

                                    <th scope="col">First Train Arrival (Military)</th>

                                    <th scope="col">Frequency</th>

                                    <th scope="col">Minutes To Next Train (Military)</th>

                                </tr>

                            </thead>

                            <tbody>

                            </tbody>

                        </table>

                    </div>

                </div>

            </div>

        </div>



        <div class="row">

            <div class="col-md-12">

                <!-- Add train  -->

                <div class="card mb-4">

                    <div class="card-header">Add train</div>

                    <div class="card-body">



                        <!-- Entry Form -->

                        <form>

                            <div class="form-group">

                                <label for="train-name-input">Train Name</label>

                                <input class="form-control" id="train-name-input" placeholder="Chicago Express" type="text">

                            </div>

                            <div class="form-group">

                                <label for="destination-input">Destination</label>

                                <input class="form-control" id="destination-input" placeholder="New York" type="text">

                            </div>

                            <div class="form-group">

                                <label for="first_train-input">First_train Arrival (Military)</label>

                                <input class="form-control" id="first_train-input" placeholder="0000" type="text">

                            </div>

                            <div class="form-group">

                                <label for="minutes-input">Minutes</label>

                                <input class="form-control" id="minutes-input" placeholder="0000" type="text">

                            </div>

                            <button class="btn btn-primary float-right" id="add-train-btn">Submit</button>

                        </form>



                    </div>

                </div>

            </div>

        </div>



    </div>



    <!-- JavaScript -->

    <script src="script.js"></script>


<!-- // Example Time Math

// -----------------------------------------------------------------------------

// Assume train first_train date of January 1, 2015

// Assume current date is March 1, 2016



// We know that this is 15 frequency.

// Now we will create code in moment.js to confirm that any attempt we use meets this test case -->

<script>
var config = {

apiKey: "AIzaSyBtWngpI_f8y3o8aHp03NKH6U8b79fV5Tw",

authDomain: "train-time-d915a.firebaseapp.com",

databaseURL: "https://train-time-d915a.firebaseio.com",

projectId: "train-time-d915a",

storageBucket: "train-time-d915a.appspot.com",

messagingSenderId: "137311122151"

};

firebase.initializeApp(config);









var database = firebase.database();



// 2. Button for adding trains

$("#add-train-btn").on("click", function (event) {

event.preventDefault();



// Grabs user input

var trnName = $("#train-name-input").val().trim();

var trndestination = $("#destination-input").val().trim();

var trnfirst_train = moment($("#first_train-input").val().trim(), "0000").format("X");

var trnminutes = $("#minutes-input").val().trim();



// Creates local "temporary" object for holding train data

var newtrn = {

    name: trnName,

    destination: trndestination,

    first_train: trnfirst_train,

    minutes: trnminutes

};



// Uploads train data to the database

database.ref().push(newtrn);



// Logs everything to console

console.log(newtrn.name);

console.log(newtrn.destination);

console.log(newtrn.first_train);

console.log(newtrn.minutes);



alert("train successfully added");



// Clears all of the text-boxes

$("#train-name-input").val("");

$("#destination-input").val("");

$("#first_train-input").val("");

$("#minutes-input").val("");

});



// 3. Create Firebase event for adding train to the database and a row in the html when a user adds an entry

database.ref().on("child_added", function (childSnapshot) {

console.log(childSnapshot.val());



// Store everything into a variable.

var trnName = childSnapshot.val().name;

var trndestination = childSnapshot.val().destination;

var trnfirst_train = childSnapshot.val().first_train;

var trnminutes = childSnapshot.val().minutes;



// train Info

console.log(trnName);

console.log(trndestination);

console.log(trnfirst_train);

console.log(trnminutes);



// Prettify the train first_train

var trnfirst_trainPretty = moment.unix(trnfirst_train).format("0000");



// Calculate the frequency worked using hardcore math

// To calculate the frequency worked

var trnfrequency = moment().diff(moment(trnfirst_train, "X"), "frequency");

console.log(trnfrequency);



// Calculate the total minutes

// var trn = trnfrequency * trnminutes;





// Create the new row

var newRow = $("<tr>").append(

    $("<td>").text(trnName),

    $("<td>").text(trndestination),

    $("<td>").text(trnfirst_trainPretty),

    $("<td>").text(trnfrequency),

    $("<td>").text(trnminutes),

    $("<td>").text(trnBilled)

);



// Append the new row to the table

$("#train-table > tbody").append(newRow);

});</script>


</body>

</html>